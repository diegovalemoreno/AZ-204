1. [Choose a messaging model in Azure to loosely connect your services](https://docs.microsoft.com/en-us/learn/modules/choose-a-messaging-model-in-azure-to-connect-your-services/)
    
    **What is a Message?**<br/>
    In the terminology of distributed applications, messages have the following characteristics:
    - A message contains raw data, produced by one component, that will be consumed by another component.
    - A message contains the data itself, not just a reference to that data.
    - The sending component expects the message content to be processed in a certain way by the destination component. The integrity of the overall system may depend on both sender and receiver doing a specific job.
    <br/>
    
    **What is an Event?**<br/>
    Events are lighter weight than messages, and are most often used for broadcast communications. The components sending the event are known as publishers, and receivers are known as subscribers.<br/>
    With events, receiving components will generally decide in which communications they are interested, and will "subscribe" to those events. The subscription is managed by an intermediary, like Azure Event Grid or Azure Event Hubs. When publishers send an event, the intermediary will route that event to interested subscribers. This pattern is known as a "publish-subscribe architecture." It's not the only way to deal with events, but it is the most common.<br/>
     <br/>
    Events have the following characteristics:
    - An event is a lightweight notification that indicates that something happened.
    - The event may be sent to multi**ple receivers, or to none at all.
    - Events are often intended to "fan out," or have a large number of subscribers for each publisher.
    - The publisher of the event has no expectation about the action a receiving component takes.
    - Some events are discrete units and unrelated to other events.
    - Some events are part of a related and ordered series. <br/> 
    <br/> 
    
    **How to choose messages or events?**<br/>
    **Events** are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none is currently subscribing. **Messages** are more likely to be used where the distributed application requires a guarantee that the communication will be processed.<br/>
    <br/>
    For each communication, consider the following question: **Does the sending component expect the communication to be processed in a particular way by the destination component?**<br/>
    If the answer is yes, choose to use a message. If the answer is no, you may be able to use events.<br/>
    
    Azure offers two solution to message-based approach, **Azure Queue Storage** & **Azure Service Bus**<br/>
    
    **Azure Queue Storage** - Queue storage is a service that uses Azure Storage to store large numbers of messages that can be securely accessed from anywhere in the world using a simple REST-based interface. Queues can contain millions of messages, limited only by the capacity of the storage account that owns it.
    
    **Azure Service Bus Queues** - Service Bus is a message broker system intended for enterprise applications. These apps often utilize multiple communication protocols, have different data contracts, higher security requirements, and can include both cloud and on-premises services. Service Bus is built on top of a dedicated messaging infrastructure designed for exactly these scenarios.
    
    **Azure Service Bus Topics** - Azure Service Bus topics are like queues, but can have multiple subscribers. When a message is sent to a topic instead of a queue multiple components can be triggered to do their work. Internally, topics use queues. When you post to a topic, the message is copied and dropped into the queue for each subscription. The queue means that the message copy will stay around to be processed by **each subscription branch** even if the component processing that subscription is too busy to keep up.
    
    **Benefits of Queue**<br/>
    Queue infrastructures can support many advanced features that make them very useful in the following ways:
    
    - **Increased reliability**<br/>
    Queues are used by distributed applications as a temporary storage location for messages pending delivery to a destination component. The source component can add a message to the queue and destination components can retrieve the message at the front of the queue for processing. Queues increase the reliability of the message exchange because, at times of high demand, messages can simply wait until a destination component is ready to process them.
        
    - **Message delivery guarantees**<br/>
    Queuing systems usually guarantee delivery of each message in the queue to a destination component. However, these guarantees can take different approaches:
        - At-Least-Once Delivery - In this approach, each message is guaranteed to be delivered to at least one of the components that retrieve messages from the queue.<br/>
        **Note** - In certain circumstances, it is possible that the same message may be delivered more than once. For example, if there are two instances of a web app retrieving messages from a queue, ordinarily each message goes to only one of those instances. However, if one instance takes a long time to process the message, and a time-out expires, the message may be sent to the other instance as well. Your web app code should be designed with this possibility in mind.<br/>
        
        - At-Most-Once Delivery - In this approach, each message is not guaranteed to be delivered, and there is a very small chance that it may not arrive. However, unlike At-Least-Once delivery, there is no chance that the message will be delivered twice. 
        
        - First-In-First-Out (FIFO) -  In most messaging systems, messages usually leave the queue in the same order in which they were added, but you should consider whether this order is guaranteed. If your distributed application requires that messages are processed in precisely the correct order, you must choose a queue system that includes a FIFO guarantee.
        
    - **Transaction support**<br/>
    Some closely related groups of messages may cause problems when delivery fails for one message in the group.<br/>
    For example, consider an e-commerce application. When the user clicks the Buy button, a series of messages might be generated and sent off to various processing destinations:
        - A message with the order details is sent to a fulfillment center
        - A message with the total and payment details is sent to a credit card processor.
        - A message with the receipt information is sent to a database to generate an invoice for the customer<br/>
    
    In this case, we want to make sure all messages get processed, or none of them are processed. We won't be in business long if the credit card message is not delivered, and all our orders are fulfilled without payment! You can avoid these kinds of problems by grouping the two messages into a transaction. Message transactions succeed or fail as a single unit - just like in the database world.<br/>
    
    **Choose Service Bus Topics if**
    - you need multiple receivers to handle each message
    <br/>
    
    **Choose Service Bus queues if**
    - You need an At-Most-Once delivery guarantee.
    - You need a FIFO guarantee.
    - You need to group messages into transactions.
    - You want to receive messages without polling the queue.
    - You need to provide a role-based access model to the queues.
    - You need to handle messages larger than 64 KB but less than 256 KB.
    - Your queue size will not grow larger than 80 GB.
    - You would like to be able to publish and consume batches of messages.
    <br/>
    
    **Choose Queue storage if**
    - You need an audit trail of all messages that pass through the queue.
    - You expect the queue to exceed 80 GB in size.
    - You want to track progress for processing a message inside of the queue.
    <br/>
    
    **What is Azure Event Grid?**<br/>
    Azure Event Grid is a fully-managed event routing service running on top of Azure Service Fabric. Event Grid distributes events from different sources, such as Azure Blob storage accounts or Azure Media Services, to different handlers, such as Azure Functions or Webhooks. Event Grid was created to make it easier to build event-based and serverless applications on Azure.<br/>
    Event Grid supports most Azure services as a publisher or subscriber and can be used with third-party services. It provides a dynamically scalable, low-cost, messaging system that allows publishers to notify subscribers about a status change. The following illustration shows Azure Event Grid receiving messages from multiple sources and distributing them to event handlers based on subscription.<br/>
    
    There are several concepts in Azure Event Grid that connect a source to a subscriber:
    - **Events**: What happened.
    - **Event sources**: Where the event took place.
    - **Topics**: The endpoint where publishers send events.
    - **Event subscriptions**: The endpoint or built-in mechanism to route events, sometimes to multiple handlers. Subscriptions are also used by handlers to filter incoming events intelligently.
    - **Event handlers**: The app or service reacting to the event.
    
    The following illustration shows an Azure Event Grid positioned between multiple event sources and multiple event handlers. The event sources send events to the Event Grid and the Event Grid forwards relevant events to the subscribers. Event Grid use topics to decide which events to send to which handlers. Events sources tag each event with one or more topics, and event handlers subscribe to the topics they are interested in.
    <br/>
    
    ![](https://docs.microsoft.com/en-us/learn/modules/choose-a-messaging-model-in-azure-to-connect-your-services/media/4-event-grid.png)
